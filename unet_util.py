from ctypes import *

#동적 라이브러리 가져오기
unet = CDLL('/data/unet_crypto/usr/lib/centos/libunetcrypto.so')

#  unet_util.c 를 python 으로 변경
pubHEX = "3082010a0282010100b6f035e17ec7c65054f3389380aa234280f0a32037c2deb35f2db6a8163cf485f008504fe2d5370782e8cdd2ed0a042adc46213ed86ce1d50b4030b91e0cd59d6b45f0810ae9d1b6fda5aadab500c346b07e7d717c73ae541a38d632318ab6eaa6f53adf2c55bda10b21532c24b05cd141489df3a7d8f4b36d39a4840e2ad9e20617d48f3dd38c583e427af17bf87390e98950c7cfb03968463b824b2bb3fe35d12380f422ca5f02432a0d7196c68853960c370b48da061d8cc01d231d2da32ad3686803f6fd1fb688aabfa7701b1704559fb8b74fb4e1b54df50cb5bf77c5d6379c62ea40e561cb4c5b4887bafa343bcd4d382e539b38f848157a42f0a86ce10203010001";
priHEX = "308204c2020100300d06092a864886f70d0101010500048204ac308204a80201000282010100b6f035e17ec7c65054f3389380aa234280f0a32037c2deb35f2db6a8163cf485f008504fe2d5370782e8cdd2ed0a042adc46213ed86ce1d50b4030b91e0cd59d6b45f0810ae9d1b6fda5aadab500c346b07e7d717c73ae541a38d632318ab6eaa6f53adf2c55bda10b21532c24b05cd141489df3a7d8f4b36d39a4840e2ad9e20617d48f3dd38c583e427af17bf87390e98950c7cfb03968463b824b2bb3fe35d12380f422ca5f02432a0d7196c68853960c370b48da061d8cc01d231d2da32ad3686803f6fd1fb688aabfa7701b1704559fb8b74fb4e1b54df50cb5bf77c5d6379c62ea40e561cb4c5b4887bafa343bcd4d382e539b38f848157a42f0a86ce102030100010282010048cd45940ca13231cbecd32a183d1d351d1d26bdee92f58f8aa42599b4e7e323de4760b6b9fdc21d922255aec838813a11593367d0375c942d1b0988d205a7893324ad369d8239bc4a2b00d872c9efec94d671d39504706ef5d482a18d07b80da00dddb4eceede3d55b19868ebdce7c33ae8cc3b2823f615e5b4d7dcd9ca81d47db4543ad8a0e9a9349a8f9b9c48612264314761323c65a97639b12fd0be5300f6765786b7285166aee7a881d86fbe6c541c01f540172cd8dab0e2c8c5781fd3ac1d7ed22af34eace0e5feec0011383da652a0ad78a298a96fb611bfe52180cb7d6b897e7947f84bbe56b082987883fd35d8a7fd5e4988b505bc6f37ce9a14c10282008100e50fb5bf7ff4e4ad74801bcf0dd06dd5e7d1b43ad193afd913f848b569346f2e061b32a9b34355828b466c5a974cf4e1617f548a574a60ecd6a49b40462d970fde0f4bc49d9a411063aece0c0ef6af07eea55c0f6464a59392a641aa51034601e1bac01d07866e1f766ea5834e687985f806cbd4ee120a1fd11578ac898083c90282008100cc73e2ddb5ebe733c309b306ca6c3f10c5a1285e7370e73890afd99066b11c37005e067d41055e2d878dcec1bb08f19123845ab8e959e2cfea29786352bf0425995ad92bcf00674f364cd0e94bac635d352e4bcfba645592cb2a2fb4270d7c50c674b921c998baffb91f080bd3423a7dfbee1d373eda88d6cfbcf75dfc1bbc59028200804ec27615a0638df56e2756687d317b729f40e59d8bce221a9bd934f6db73a1fecb2eb2ded2ba863e5ab11e348fed700dc6be474d41f25b1d54384901729fde5f2055561206b6b1447761f58b03e22210b227bd5db5813dc55e19385edd7828ac20f75b731fd143302242ad3a56cd696b7cfaa93f4f947852b44b93b08f9ed6b10282008100b08358997bc7b86b7af6b3c6a81abe73f77c04834efd69d2ef2fb3113567b16956fad6756b1e7c49a89f68a2df9c801a83647082f68c3102ba32a58a72d5117a78a4f39c1bf2483f1e2d41ac393612ef54cbac8e22691f6c45d51d2c570f108618608bb93cf88c71dd5c8a30d36a795f6d930d4c360aac5b712cbf103869a5b902820080169ca2f9adfcb4b1a3616888c56c57010b259b5634b2321be2f4bcd51661914d41edb415a7236cfd75cb848cbb9ac531a329e2fb3e884acb76b4215079d77b07fde74904e8a3be998084c16c4871e69f7a0df78d95aae72322c92f5cde23d97ad817839bd1754d4a210ded3d618d60bef8dd5b22bf8b84f4ca89d66cd06c614c"

cPlain = create_string_buffer(4096)
cBase64Enc = create_string_buffer(4096)
cBase64Dec = create_string_buffer(4096)
cPlainHex = create_string_buffer(4096)
base64_len = c_int()
base64_len_p = pointer(base64_len)

plain_len = c_int()

cplain_len = c_int()
cplain_len = len(priHEX) / 2

print("PLAIN LEN = [", cplain_len, "]")

cpriHEX = priHEX.encode('utf-8')
#cpriHEX = create_string_buffer(bytes(temp))
unet.TNC_HEX2BIN.argtypes = (POINTER(c_char), POINTER(c_char), c_int)
unet.TNC_HEX2BIN(cPlain, cpriHEX, len(priHEX))

unet.TNC_ENCODE_BASE64.argtypes = (POINTER(c_char), POINTER(c_int), POINTER(c_char), c_int)
unet.TNC_ENCODE_BASE64(cBase64Enc, base64_len_p, cPlain, 1222)

print("BASE64    = [", cBase64Enc.value, "]")
print("BASE64LEN = [", base64_len, "]")

unet.TNC_DECODE_BASE64.argtypes = (POINTER(c_char), POINTER(c_int), POINTER(c_char), c_int)
unet.TNC_DECODE_BASE64(cBase64Dec, plain_len, cBase64Enc, base64_len)
unet.TNC_BIN2HEX(cPlainHex, cBase64Dec, plain_len)

print("PlainHEX  = [", cPlainHex.value, "]")



